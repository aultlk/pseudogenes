import pandas as pd

# load file with duplicate count and v identity single cell info 
data = pd.read_csv('../filtering2_rearrangements_single-cell.tsv', sep='\t')

# split v_call column so that multiple alleles are separated into a list of alleles
data['v_call'] = data['v_call'].str.split(',')

# convert list of alleles into their own row
data = data.explode('v_call')

# delete allele numbers but keep gene names
data['v_call'] = data['v_call'].str.replace('\*\d*', '')

# remove unknown number tagged onto the source_id 
# cannot find this number in jointSampleSheet.csv 
# only identifiers in jointSampleSheet are: 
# cell_id and source_id = flow_cell-lane-index
data['source_id'] = data['source_id'].str.replace('IG\-mapped.*', '')

# subset on 'status' == 'good'
data = data[data['status'] == 'good']

data.duplicated().sum()

